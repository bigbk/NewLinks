
<!doctype html>
<html>

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
	
<title>VIN Search</title>

<style type="text/css">
	input {width: 200px;}
	/*body {background-color:#77c2e6; font-family: Roboto,Verdana,Arial,sans-serif;}*/

</style>
	
	

<!-- <link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Chivo:400,700,900|Signika+Negative:300,400,600,700" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"  -->

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="style.css">	 

<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script type="text/javascript"></script>

</head>

	
<body style="background-color:#003366;">

	<div class="row" align="center">
	
	<div class="row" align="left" style="background-color:#fff;">
		<div class="column left">
		</div>
		<div class="column middle">
		<h1 class="font-weight-bold">
		<span>VIN</span>
		<span class="text-primary"> RESEARCH<span class="special-decoration">LINKS</span></span>
		</h1> </br>
		</div>
		<div class="column right">
		</div>
	</div>
	
	<input type="text" id="b12" placeholder="VIN - 17 Digits" name="name" maxlength="100" style="border-radius: 10px; border: 2px solid #609; padding: 20px; width: 200px; height: 15px;">
	<button id="btn_submit">Submit</button>

	<div class="row" align="left"	 style="background-color:#fff;">
		<div class="column left">
		test 1

		
		</div>
		<div class="column middle">
				     
																																			 
		<div id="chrysler_div" style="display:block; background-color:#fff;">
			<p><span style="font-size: 16px; background-color:#fdde58; color: #036; font-family: Montserrat,'Trebuchet MS',Helvetica,sans-serif;"><strong> These links work for Chrysler, Jeep, RAM, Fiat, Alfa Romeo</strong></span><br></p>
        	<a id="chr" class="btn btn-link" title="This will open PDF window sticker" style="cursor:pointer;border-style:none;background:#ffffff;" onclick="chrysler()"><span class="glyphicon glyphicon-edit"></span> Window sticker </a> <br>
			
		</div>
		
		</div>
		
		<div class="column right">
				     test 3
		</div>
	</div>
	<div class="row" align="left"	style="background-color:#fff;">
		<div class="col-md-4">
				     test 21
		</div>
		<div class="col-md-4">
				     test 22
		</div>
		<div class="col-md-4" >
				     test 23
		</div>

	</div>
	<div>
				     
	<div class="container-fluid" align="center" "style="background-color:#003366;">
		<div align="center" "style="background-color:#003366;">

			<div>
				<output name="output" id="output">
				
				</output>
			</div>

		</div>

		<div id="nhtsa_data" style="display:none; background-color:#003366;">
        <textarea id="txt_results" rows="15" cols="100" placeholder="Vehicle Data Presented Here"></textarea>
		</div>
	

		
	</div>
			



<script>
	var vin;
	var aYear;
	var aMake;
	var aModel;
	
document.getElementById("btn_submit").onclick = function () {
  //var vin;
  vin = document.getElementById("b12").value;
	vin = vin.replace(/ +/g, "");					      
	if (vin[0] == '{') {
	vin = vin.slice(1,-1);
	}
	vin = vin.toUpperCase();
	document.getElementById("b12").value = vin;
  if (vin.length === 17) {
	  getNHTSADataByVIN(vin);
  } else {
       alert("VIN number should be 17 digits long, currently " + vin.length + " digits entered.");
}

};


function getNHTSADataByVIN (param_vin) {
  $.ajax({
    url: "https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVINValuesBatch/",
    //url: "https://obw.carmax.com/api/v1/blackbook/BlackBookVinValues/",
    type: "POST",
    data: { format: "json", data: param_vin },
    dataType: "json",
    success: function(result)
    {
      console.log(result);

  //alert("Make: " + result.Results[0].Make);

	if ( result.Results[0].ModelYear !== "")  { 
		aYear = result.Results[0].ModelYear
	} else {
		aYear = ""
	};
	if ( result.Results[0].Make !== "")  { 
		aMake = " " + result.Results[0].Make 
	} else {
		aMake = ""
	};
	if ( result.Results[0].Model !== "")  { 
		aModel = " " + result.Results[0].Model 
	} else {
		aModel = ""
	};
	if ( result.Results[0].Trim!== "")  { 
		aTrim = " " + result.Results[0].Trim
	} else {
		aTrim = ""
	};
	if ( result.Results[0].DisplacementL !== "")  { 
		aDisp = ", " + result.Results[0].DisplacementL + "L"
	} else {
		aDisp = ""
	};
	if ( result.Results[0].EngineCylinders !== "")  { 
		aCyl = ", " + result.Results[0].EngineCylinders + "cyl"
	} else {
		aCyl = ""
	};
	if ( result.Results[0].DriveType !== "")  { 
		aDrive = ", " + result.Results[0].DriveType
	} else {
		aDrive= ""
	};
	if ( result.Results[0].Doors !== "")  { 
		aDoor = ", " + result.Results[0].Doors + "D"
	} else {
		aDoor= ""
	};
	if ( result.Results[0].BodyCabType !== "")  { 
		aCab = ", " + result.Results[0].BodyCabType
	} else {
		aCab = ""
	};
	if ( result.Results[0].BodyClass !== "")  { 
		aBody = ", " + result.Results[0].BodyClass
	} else {
		aBody= ""
	};

 	
	document.getElementById("output").innerText = aYear + aMake + aModel + aTrim + aDisp + aCyl + aDrive  + " \n " + aDoor + aCab + aBody + " \r\n ";;
	//document.getElementById("output").value += aDoor + aCab + aBody + " \r\n ";

      displayNHTSAResults(result);
    },
    error: function(xhr, ajaxOptions, thrownError)
    {
        console.log(xhr.status);
        console.log(thrownError);
    }
  });
};
	
function displayNHTSAResults (param_data) {
	var output_text = "";
	for (var i = 0; i < param_data.Results.length; i++) {
		var result = param_data.Results[i];
		for (var prop in result) {
			if (result.hasOwnProperty(prop) && result[prop] !== "") {
				output_text += prop + ": " + result[prop] + "\n";
			}
		}
	}
	document.getElementById("txt_results").value = output_text;
	
	//var e = document.getElementById("nhtsa_data");
    //e.style.display = (e.style.display == 'block') ? 'none' : 'block';
	
	//document.getElementById("nhtsa_data").style.display = (document.getElementById("nhtsa_data").style.display == 'block') ? 'none' : 'block';
	
	document.getElementById("nhtsa_data").style.display = 'block';
	updatedisplay ();
	

};
	
function updatedisplay ( ) {
	if (aMake == "Chrysler") {
	document.getElementById("chrysler_div").style.display = 'block';
	} else {
		document.getElementById("chrysler_div").style.display = 'none';
	}
};

function chrysler() {
	window.open("https://www.chrysler.com/hostd/windowsticker/getWindowStickerPdf.do?vin="+vin);
};
	
</script>
	
</body>
</html>
