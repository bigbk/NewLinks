<!DOCTYPE html>
<html>

<head>
<title>VIN Decoder API Test</title>

<style type="text/css">
input {width: 200px;}
</style>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script type="text/javascript">
</script>

</head>

<body>
  <table align="center">
    <tr>
      <td align="center">
        <input type="text" id="b12" placeholder="VIN - 17 Digits" name="name" maxlength="100">
      </td>
    </tr>
    <tr>
      <td align="center">
        <button id="btn_submit">Submit</button>
        
      </td>
    </tr>
    <tr>
      <td>
        <textarea id="txt_results" rows="15" cols="100" placeholder="OBW Vehicle Data Presented Here"></textarea>
      </td>
    </tr>
  </table>


<script>

document.getElementById("btn_submit").onclick = function () {
  var vin;

  vin = document.getElementById("b12").value;

  if (vin.length === 17) {
    getNHTSADataByVIN(vin);
  }
};

function getNHTSADataByVIN (param_vin) {
  $.ajax({
    //url: "https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVINValuesBatch/",
    url: "https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVin",
    type: "POST",
    data: { format: "json", data: param_vin },
    dataType: "json",
    success: function(result)
    {
      console.log(result);
      displayNHTSAResults(result);
    },
    error: function(xhr, ajaxOptions, thrownError)
    {
        console.log(xhr.status);
        console.log(thrownError);
    }
  });
};

function displayNHTSAResults (param_data) {
  var output_text = "";

  for (var i = 0; i < param_data.Results.length; i++) {
    var result = param_data.Results[i];

    for (var prop in result) {
      if (result.hasOwnProperty(prop) && result[prop] !== "") {
        output_text += prop + ": " + result[prop] + "\n";
      }
    }
  }

  document.getElementById("txt_results").value = output_text;
};

</script>
                                                
</body>
</html>
